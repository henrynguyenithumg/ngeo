!function(e){function t(t){for(var r,i,l=t[0],u=t[1],s=t[2],p=0,d=[];p<l.length;p++)i=l[p],a[i]&&d.push(a[i][0]),a[i]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);for(h&&h(t);d.length;)d.shift()();return o.push.apply(o,s||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,l=1;l<n.length;l++){var u=n[l];0!==a[u]&&(r=!1)}r&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},a={22:0},o=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var l=window.webpackJsonp=window.webpackJsonp||[],u=l.push.bind(l);l.push=t,l=l.slice();for(var s=0;s<l.length;s++)t(l[s]);var h=u;o.push([419,0]),n()}({418:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),n(609),n(203);var r=g(n(83)),a=g(n(220)),o=g(n(209)),i=g(n(70)),l=g(n(33)),u=g(n(52)),s=g(n(61)),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(2)),p=g(n(40)),d=g(n(49)),f=g(n(166)),c=g(n(79)),m=g(n(163));function g(e){return e&&e.__esModule?e:{default:e}}var _={};_.module=angular.module("gmfapp",["gettext",a.default.name,o.default.module.name,i.default.name]),_.module.value("authenticationBaseUrl","https://geomapfish-demo.camptocamp.net/2.2/wsgi"),_.module.value("gmfLayersUrl","https://geomapfish-demo.camptocamp.net/2.2/wsgi/layers/"),_.module.constant("defaultTheme","Demo"),_.module.constant("angularLocaleScript","../build/angular-locale_{{locale}}.js"),_.MainController=function(t,n,a){this.scope_=t,this.editFeature_=n,this.gmfUser=a,this.wmsSource_=new m.default({url:"https://geomapfish-demo.camptocamp.net/2.2/wsgi/mapserv_proxy",params:{LAYERS:"point"}}),this.wmsLayer_=new f.default({source:this.wmsSource_}),this.pixelBuffer_=10,this.layerId_=113,this.feature=null,this.pending=!1,this.map=new u.default({layers:[new d.default({source:new c.default}),this.wmsLayer_],view:new s.default({projection:r.default,resolutions:[200,100,50,20,10,5,2.5,2,1,.5],center:[537635,152640],zoom:2})}),this.map.on("singleclick",this.handleMapSingleClick_,this),e('[data-toggle="tooltip"]').tooltip({container:"body",trigger:"hover"})},_.MainController.$inject=["$scope","gmfEditFeature","gmfUser"],_.MainController.prototype.handleMapSingleClick_=function(e){var t=e.coordinate,n=this.map.getView().getResolution()*this.pixelBuffer_,r=h.buffer([t[0],t[1],t[0],t[1]],n);this.editFeature_.getFeaturesInExtent([this.layerId_],r).then(this.handleGetFeatures_.bind(this)),this.feature=null,this.pending=!0,this.scope_.$apply()},_.MainController.prototype.handleGetFeatures_=function(e){this.pending=!1,e.length&&(this.feature=e[0])},_.MainController.prototype.insertFeature=function(){this.pending=!0;var e=this.map,t=e.getView(),n=-50*t.getResolution(),r=e.getSize(),a=h.buffer(t.calculateExtent(r),n),o=h.getBottomLeft(a),i=h.getTopRight(a),u=o[0],s=o[1],d=i[0],f=d-u,c=i[1]-s,m=[u+Math.random()*f,d+Math.random()*c],g=new l.default({geometry:new p.default(m),name:"New point"});this.editFeature_.insertFeatures(this.layerId_,[g]).then(this.handleEditFeature_.bind(this))},_.MainController.prototype.updateFeature=function(){console.assert(this.feature),this.pending=!0,this.feature.set("name","Updated name"),this.editFeature_.updateFeature(this.layerId_,this.feature).then(this.handleEditFeature_.bind(this)),this.feature=null},_.MainController.prototype.deleteFeature=function(){console.assert(this.feature),this.editFeature_.deleteFeature(this.layerId_,this.feature).then(this.handleEditFeature_.bind(this)),this.feature=null},_.MainController.prototype.handleEditFeature_=function(e){this.pending=!1,this.refreshWMSLayer_()},_.MainController.prototype.refreshWMSLayer_=function(){this.wmsSource_.updateParams({random:Math.random()})},_.module.controller("MainController",_.MainController),t.default=_}).call(this,n(24))},419:function(e,t,n){n(54),n(53),e.exports=n(418)},609:function(e,t){}});
//# sourceMappingURL=editfeature.eaced84a8697bf32132a.js.map