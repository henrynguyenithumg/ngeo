!function(e){function t(t){for(var i,r,l=t[0],u=t[1],s=t[2],d=0,f=[];d<l.length;d++)r=l[d],a[r]&&f.push(a[r][0]),a[r]=0;for(i in u)Object.prototype.hasOwnProperty.call(u,i)&&(e[i]=u[i]);for(c&&c(t);f.length;)f.shift()();return o.push.apply(o,s||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],i=!0,l=1;l<n.length;l++){var u=n[l];0!==a[u]&&(i=!1)}i&&(o.splice(t--,1),e=r(r.s=n[0]))}return e}var i={},a={2:0},o=[];function r(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=i,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var l=window.webpackJsonp=window.webpackJsonp||[],u=l.push.bind(l);l.push=t,l=l.slice();for(var s=0;s<l.length;s++)t(l[s]);var c=u;o.push([314,0]),n()}({307:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(300),r=(i=o)&&i.__esModule?i:{default:i};var l=function(e){function t(e,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i));return a.rootScope_=n,a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),a(t,[{key:"toggle3d",value:function(){var e=this;return function e(t,n,i){null===t&&(t=Function.prototype);var a=Object.getOwnPropertyDescriptor(t,n);if(void 0===a){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in a)return a.value;var r=a.get;return void 0!==r?r.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toggle3d",this).call(this).then(function(){e.rootScope_.$apply()})}}]),t}();t.default=l},308:function(e,t){e.exports='<div class=ngeo-tools> <div class=ngeo-angle><div class=ngeo-angle3d></div></div> <button class="ngeo-left ngeo-tilt-left" ng-click=$ctrl.tilt(5)></button> <button class="ngeo-right ngeo-tilt-right" ng-click=$ctrl.tilt(-5)></button> </div> <div class=ngeo-zoom> <button class=ol-zoom-in ng-click=$ctrl.zoom(1)></button> <button class=ol-zoom-out ng-click=$ctrl.zoom(-1)></button> </div> <div class=ngeo-tools> <div class=ngeo-rotation><div class=ngeo-rotation3d></div></div> <button class=ngeo-left ng-click=$ctrl.rotate(-15)></button> <button class=ngeo-right ng-click=$ctrl.rotate(15)></button> </div> '},309:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=l(n(9)),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(70)),r=l(n(58));function l(e){return e&&e.__esModule?e:{default:e}}c.$inject=["$attrs","ngeoOlcsControls3dTemplateUrl"];var u=angular.module("ngeoOlcsControls3d",[]);var s=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.element_=t,this.ol3dm,this.minTilt,this.maxTilt,this.tiltRightEl_,this.tiltLeftEl_,this.rotation3dEl_,this.angle3dEl_,this.previousRotation_,this.previousViewMatrix_,this.animationFrameRequestId_,this.olcsService_=n}return e.$inject=["$element","ngeoOlcsService"],i(e,[{key:"updateWidget_",value:function(){var e,t,n=this,i=this.ol3dm.getOl3d().getOlView().getRotation();e=this.previousRotation_,t=i,Number.isFinite(t)&&(!Number.isFinite(e)||Math.abs(t-e)>.05)&&(this.rotateElement_(this.rotation3dEl_,i),this.previousRotation_=i);var a=this.ol3dm.getCesiumViewMatrix();if(!Cesium.Matrix4.equalsEpsilon(this.previousViewMatrix_,a,1e-5)){var o=this.ol3dm.getTiltOnGlobe();if(Number.isFinite(o||0)){this.rotateElement_(this.angle3dEl_,o),this.previousViewMatrix_=Cesium.Matrix4.clone(a);o-this.minTilt<.01?this.tiltRightEl_.addClass("ngeo-right-inactive"):this.tiltRightEl_.hasClass("ngeo-right-inactive")&&this.tiltRightEl_.removeClass("ngeo-right-inactive"),this.maxTilt-o<.01?this.tiltLeftEl_.addClass("ngeo-left-inactive"):this.tiltLeftEl_.hasClass("ngeo-left-inactive")&&this.tiltLeftEl_.removeClass("ngeo-left-inactive")}}this.animationFrameRequestId_=requestAnimationFrame(function(){return n.updateWidget_()})}},{key:"$onDestroy",value:function(){this.animationFrameRequestId_&&cancelAnimationFrame(this.animationFrameRequestId_)}},{key:"$onInit",value:function(){void 0===this.minTilt&&(this.minTilt=0),void 0===this.maxTilt&&(this.maxTilt=7*Math.PI/16),this.ol3dm||(this.ol3dm=a.default.assert(this.olcsService_.getManager())),this.tiltRightEl_=this.element_.find(".ngeo-tilt-right"),this.tiltLeftEl_=this.element_.find(".ngeo-tilt-left"),this.rotation3dEl_=this.element_.find(".ngeo-rotation3d"),this.angle3dEl_=this.element_.find(".ngeo-angle3d"),this.updateWidget_()}},{key:"rotateElement_",value:function(e,t){var n="rotate("+t+"rad)";e.css({"-moz-transform":n,"-webkit-transform":n,"-o-transform":n,"-ms-transform":n,transform:n})}},{key:"rotate",value:function(e){e=Cesium.Math.toRadians(e),this.ol3dm.setHeading(e)}},{key:"tilt",value:function(e){e=Cesium.Math.toRadians(e);var t=this.ol3dm.getTiltOnGlobe();t+e<this.minTilt?e=this.minTilt-t:t+e>this.maxTilt&&(e=this.maxTilt-t);var n=this.ol3dm.getCesiumScene();r.default.rotateAroundBottomCenter(n,e)}},{key:"zoom",value:function(e){var t=this.ol3dm.getOlView(),n=t.getResolution(),i=t.constrainResolution(n,e);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:i,duration:250,easing:o.easeOut})}}]),e}();function c(e,t){if(t)return t;var n=e.ngeoOlcsControls3dTemplateUrl;return n||"ngeo/olsc/controls3d"}u.run(["$templateCache",function(e){e.put("ngeo/olsc/controls3d",n(308))}]);var d={bindings:{minTilt:"<?",maxTilt:"<?",ol3dm:"<?"},controller:s,templateUrl:c};u.component("ngeoOlcsControls3d",d),u.value("ngeoOlcsControls3dTemplateUrl",""),t.default=u},310:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={Permalink3dParam:{ENABLED:"3d_enabled",LON:"3d_lon",LAT:"3d_lat",ELEVATION:"3d_elevation",HEADING:"3d_heading",PITCH:"3d_pitch",PREFIX:"3d_"}};t.default=i},311:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=s(n(9)),o=s(n(207)),r=s(n(235)),l=s(n(310)),u=s(n(260));function s(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.manager_,this.ngeoDebounce_=t,this.ngeoLocation_=n,this.ngeoStateManager_=i}return e.$inject=["ngeoDebounce","ngeoLocation","ngeoStateManager"],i(e,[{key:"initialize",value:function(e){var t=this;this.manager_=e,this.manager_.on("load",function(){t.cameraToState_()}),this.ngeoStateManager_.getInitialBooleanValue("3d_enabled")&&this.initialStateToCamera_()}},{key:"getManager",value:function(){return this.manager_}},{key:"initialStateToCamera_",value:function(){var e=this.ngeoStateManager_,t=e.getInitialNumberValue(l.default.Permalink3dParam.LON),n=e.getInitialNumberValue(l.default.Permalink3dParam.LAT),i=e.getInitialNumberValue(l.default.Permalink3dParam.ELEVATION),o=e.getInitialNumberValue(l.default.Permalink3dParam.HEADING)||0,r=e.getInitialNumberValue(l.default.Permalink3dParam.PITCH)||0;return a.default.assert(void 0!==t),a.default.assert(void 0!==n),a.default.assert(void 0!==i),this.manager_.set3dWithView(t,n,i,o,r)}},{key:"cameraToState_",value:function(){var e=this,t=this.manager_.getOl3d().getCesiumScene().camera;t.moveEnd.addEventListener(this.ngeoDebounce_(function(){var n,i=t.positionCartographic;e.ngeoStateManager_.updateState((c(n={},l.default.Permalink3dParam.ENABLED,!0),c(n,l.default.Permalink3dParam.LON,Cesium.Math.toDegrees(i.longitude).toFixed(5)),c(n,l.default.Permalink3dParam.LAT,Cesium.Math.toDegrees(i.latitude).toFixed(5)),c(n,l.default.Permalink3dParam.ELEVATION,i.height.toFixed(0)),c(n,l.default.Permalink3dParam.HEADING,Cesium.Math.toDegrees(t.heading).toFixed(3)),c(n,l.default.Permalink3dParam.PITCH,Cesium.Math.toDegrees(t.pitch).toFixed(3)),n))},1e3,!0)),this.manager_.on("toggle",function(t){t.target.is3dEnabled()||e.remove3dState_()})}},{key:"remove3dState_",value:function(){var e=this;this.ngeoLocation_.getParamKeysWithPrefix(l.default.Permalink3dParam.PREFIX).forEach(function(t){e.ngeoStateManager_.deleteParam(t)})}}]),e}(),f="ngeoOlcsService";d.module=angular.module(f,[o.default.name,r.default.module.name,u.default.module.name]).service(f,d);var m=d;t.default=m},312:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(311)),a=o(n(309));function o(e){return e&&e.__esModule?e:{default:e}}var r=angular.module("ngeoOlcsModule",[a.default.name,i.default.module.name]);t.default=r},313:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(498),n(34);var i=c(n(39)),a=c(n(49)),o=c(n(48)),r=c(n(60)),l=c(n(312)),u=c(n(47)),s=c(n(307));function c(e){return e&&e.__esModule?e:{default:e}}var d={};d.module=angular.module("app",[u.default.name,l.default.name]),d.MainController=function(e,t){this.map=new i.default({layers:[new o.default({source:new r.default})],view:new a.default({center:[0,0],zoom:4})});this.ol3dm=new s.default("../node_modules/@camptocamp/cesium/Build/Cesium/Cesium.js",e,{map:this.map}),t.initialize(this.ol3dm)},d.MainController.$inject=["$rootScope","ngeoOlcsService"],d.module.controller("MainController",d.MainController),t.default=d},314:function(e,t,n){n(35),e.exports=n(313)},498:function(e,t){}});
//# sourceMappingURL=simple3d.7247032f3989bb6a8662.js.map