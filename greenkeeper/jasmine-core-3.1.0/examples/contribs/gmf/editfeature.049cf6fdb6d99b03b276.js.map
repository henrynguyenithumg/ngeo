{"version":3,"sources":["webpack:///./contribs/gmf/examples/editfeature.js","webpack:///./node_modules/openlayers/src/ol/source/XYZ.js","webpack:///./node_modules/openlayers/src/ol/source/OSM.js"],"names":["__webpack_require__","olExtent","exports","module","angular","_module2","default","name","_EditFeature2","_component2","value","constant","MainController","$scope","gmfEditFeature","gmfUser","this","scope_","editFeature_","wmsSource_","_ImageWMS2","url","params","LAYERS","wmsLayer_","_Image2","source","pixelBuffer_","layerId_","feature","pending","map","_Map2","layers","_Tile2","_OSM2","view","_View2","projection","resolutions","center","zoom","on","handleMapSingleClick_","$","tooltip","container","trigger","prototype","evt","coordinate","buffer","getView","getResolution","extent","getFeaturesInExtent","then","handleGetFeatures_","bind","$apply","features","length","insertFeature","size","getSize","calculateExtent","bottomLeft","getBottomLeft","topRight","getTopRight","left","bottom","right","deltaX","deltaY","Math","random","_Feature2","geometry","_Point2","insertFeatures","handleEditFeature_","updateFeature","console","assert","set","deleteFeature","resp","refreshWMSLayer_","updateParams","controller","XYZ","opt_options","options","undefined","tileGrid","Object","tilegrid","maxZoom","minZoom","tileSize","TileImage","call","attributions","cacheSize","crossOrigin","opaque","reprojectionErrorThreshold","tileLoadFunction","tilePixelRatio","tileUrlFunction","urls","wrapX","transition","ol","source_XYZ","OSM","ATTRIBUTION","__webpack_exports__"],"mappings":"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","file":"editfeature.049cf6fdb6d99b03b276.js","sourcesContent":["/**\n * @module gmfapp.editfeature\n */\nconst exports = {};\n\nimport './editfeature.css';\nimport './common_dependencies.js';\nimport EPSG21781 from 'ngeo/proj/EPSG21781.js';\n\nimport gmfAuthenticationModule from 'gmf/authentication/module.js';\nimport gmfEditingEditFeature from 'gmf/editing/EditFeature.js';\n\n/** @suppress {extraRequire} */\nimport gmfMapComponent from 'gmf/map/component.js';\n\nimport olFeature from 'ol/Feature.js';\nimport olMap from 'ol/Map.js';\nimport olView from 'ol/View.js';\nimport * as olExtent from 'ol/extent.js';\nimport olGeomPoint from 'ol/geom/Point.js';\nimport olLayerTile from 'ol/layer/Tile.js';\nimport olLayerImage from 'ol/layer/Image.js';\nimport olSourceOSM from 'ol/source/OSM.js';\nimport olSourceImageWMS from 'ol/source/ImageWMS.js';\n\n\n/** @type {!angular.Module} **/\nexports.module = angular.module('gmfapp', [\n  gmfAuthenticationModule.name,\n  gmfEditingEditFeature.module.name,\n  gmfMapComponent.name,\n]);\n\n\nexports.module.value(\n  'authenticationBaseUrl',\n  'https://geomapfish-demo.camptocamp.net/2.2/wsgi');\n\n\nexports.module.value('gmfLayersUrl',\n  'https://geomapfish-demo.camptocamp.net/2.2/wsgi/layers/');\n\nexports.constant('defaultTheme', 'Demo');\nexports.constant('angularLocaleScript', '../build/angular-locale_{{locale}}.js');\n\n\n/**\n * @param {!angular.Scope} $scope Angular scope.\n * @param {gmf.editing.EditFeature} gmfEditFeature Gmf edit feature service.\n * @param {gmfx.User} gmfUser User.\n * @constructor\n * @ngInject\n */\nexports.MainController = function($scope, gmfEditFeature, gmfUser) {\n\n  /**\n   * @type {!angular.Scope}\n   * @private\n   */\n  this.scope_ = $scope;\n\n  /**\n   * @type {gmf.editing.EditFeature}\n   * @export\n   */\n  this.editFeature_ = gmfEditFeature;\n\n  /**\n   * @type {gmfx.User}\n   * @export\n   */\n  this.gmfUser = gmfUser;\n\n  /**\n   * @type {ol.source.ImageWMS}\n   * @private\n   */\n  this.wmsSource_ = new olSourceImageWMS({\n    url: 'https://geomapfish-demo.camptocamp.net/2.2/wsgi/mapserv_proxy',\n    params: {'LAYERS': 'point'}\n  });\n\n  /**\n   * @type {ol.layer.Image}\n   * @private\n   */\n  this.wmsLayer_ = new olLayerImage({\n    source: this.wmsSource_\n  });\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.pixelBuffer_ = 10;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.layerId_ = 113;\n\n  /**\n   * @type {ol.Feature}\n   * @export\n   */\n  this.feature = null;\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.pending = false;\n\n  /**\n   * @type {ol.Map}\n   * @export\n   */\n  this.map = new olMap({\n    layers: [\n      new olLayerTile({\n        source: new olSourceOSM()\n      }),\n      this.wmsLayer_\n    ],\n    view: new olView({\n      projection: EPSG21781,\n      resolutions: [200, 100, 50, 20, 10, 5, 2.5, 2, 1, 0.5],\n      center: [537635, 152640],\n      zoom: 2\n    })\n  });\n\n  this.map.on('singleclick', this.handleMapSingleClick_, this);\n\n  // initialize tooltips\n  $('[data-toggle=\"tooltip\"]').tooltip({\n    container: 'body',\n    trigger: 'hover'\n  });\n};\n\n\n/**\n * @param {ol.MapBrowserEvent} evt MapBrowser event\n * @private\n */\nexports.MainController.prototype.handleMapSingleClick_ = function(evt) {\n\n  // (1) Launch query to fetch new features\n  const coordinate = evt.coordinate;\n  const map = this.map;\n  const view = map.getView();\n  const resolution = view.getResolution();\n  const buffer = resolution * this.pixelBuffer_;\n  const extent = olExtent.buffer(\n    [coordinate[0], coordinate[1], coordinate[0], coordinate[1]],\n    buffer\n  );\n\n  this.editFeature_.getFeaturesInExtent([this.layerId_], extent).then(\n    this.handleGetFeatures_.bind(this));\n\n  // (2) Clear any previously selected feature\n  this.feature = null;\n\n  // (3) Pending\n  this.pending = true;\n\n  this.scope_.$apply();\n};\n\n\n/**\n * @param {Array.<ol.Feature>} features Features.\n * @private\n */\nexports.MainController.prototype.handleGetFeatures_ = function(features) {\n  this.pending = false;\n\n  if (features.length) {\n    this.feature = features[0];\n  }\n};\n\n\n/**\n * Insert a new feature at a random location.\n * @export\n */\nexports.MainController.prototype.insertFeature = function() {\n\n  this.pending = true;\n\n  // (1) Create a randomly located feature\n  const map = this.map;\n  const view = map.getView();\n  const resolution = view.getResolution();\n  const buffer = resolution * -50; // 50 pixel buffer inside the extent\n  const size = /** @type {!Array.<number>} */ (map.getSize());\n  const extent = olExtent.buffer(\n    view.calculateExtent(size),\n    buffer\n  );\n  const bottomLeft = olExtent.getBottomLeft(extent);\n  const topRight = olExtent.getTopRight(extent);\n  const left = bottomLeft[0];\n  const bottom = bottomLeft[1];\n  const right = topRight[0];\n  const top = topRight[1];\n  const deltaX = right - left;\n  const deltaY = top - bottom;\n  const coordinate = [\n    left + Math.random() * deltaX,\n    right + Math.random() * deltaY\n  ];\n\n  const feature = new olFeature({\n    'geometry': new olGeomPoint(coordinate),\n    'name': 'New point'\n  });\n\n  // (2) Launch request\n  this.editFeature_.insertFeatures(\n    this.layerId_,\n    [feature]\n  ).then(\n    this.handleEditFeature_.bind(this)\n  );\n};\n\n\n/**\n * Update the currently selected feature with a new name.\n * @export\n */\nexports.MainController.prototype.updateFeature = function() {\n\n  console.assert(this.feature);\n\n  this.pending = true;\n\n  // (1) Update name\n  this.feature.set('name', 'Updated name');\n\n  // (2) Launch request\n  this.editFeature_.updateFeature(\n    this.layerId_,\n    this.feature\n  ).then(\n    this.handleEditFeature_.bind(this)\n  );\n\n  // (3) Reset selected feature\n  this.feature = null;\n};\n\n\n/**\n * Delete currently selected feature.\n * @export\n */\nexports.MainController.prototype.deleteFeature = function() {\n\n  console.assert(this.feature);\n\n  // (1) Launch request\n  this.editFeature_.deleteFeature(\n    this.layerId_,\n    this.feature\n  ).then(\n    this.handleEditFeature_.bind(this)\n  );\n\n  // (2) Reset selected feature\n  this.feature = null;\n};\n\n\n/**\n * Called after an insert, update or delete request.\n * @param {angular.$http.Response} resp Ajax response.\n * @private\n */\nexports.MainController.prototype.handleEditFeature_ = function(resp) {\n  this.pending = false;\n  this.refreshWMSLayer_();\n};\n\n\n/**\n * @private\n */\nexports.MainController.prototype.refreshWMSLayer_ = function() {\n  this.wmsSource_.updateParams({\n    'random': Math.random()\n  });\n};\n\n\nexports.module.controller('MainController', exports.MainController);\n\n\nexport default exports;\n\n\n\n// WEBPACK FOOTER //\n// ./contribs/gmf/examples/editfeature.js","/**\n * @module ol/source/XYZ\n */\nimport {inherits} from '../index.js';\nimport TileImage from '../source/TileImage.js';\nimport {createXYZ, extentFromProjection} from '../tilegrid.js';\n\n/**\n * @classdesc\n * Layer source for tile data with URLs in a set XYZ format that are\n * defined in a URL template. By default, this follows the widely-used\n * Google grid where `x` 0 and `y` 0 are in the top left. Grids like\n * TMS where `x` 0 and `y` 0 are in the bottom left can be used by\n * using the `{-y}` placeholder in the URL template, so long as the\n * source does not have a custom tile grid. In this case,\n * {@link ol.source.TileImage} can be used with a `tileUrlFunction`\n * such as:\n *\n *  tileUrlFunction: function(coordinate) {\n *    return 'http://mapserver.com/' + coordinate[0] + '/' +\n *        coordinate[1] + '/' + coordinate[2] + '.png';\n *    }\n *\n *\n * @constructor\n * @extends {ol.source.TileImage}\n * @param {olx.source.XYZOptions=} opt_options XYZ options.\n * @api\n */\nconst XYZ = function(opt_options) {\n  const options = opt_options || {};\n  const projection = options.projection !== undefined ?\n    options.projection : 'EPSG:3857';\n\n  const tileGrid = options.tileGrid !== undefined ? options.tileGrid :\n    createXYZ({\n      extent: extentFromProjection(projection),\n      maxZoom: options.maxZoom,\n      minZoom: options.minZoom,\n      tileSize: options.tileSize\n    });\n\n  TileImage.call(this, {\n    attributions: options.attributions,\n    cacheSize: options.cacheSize,\n    crossOrigin: options.crossOrigin,\n    opaque: options.opaque,\n    projection: projection,\n    reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n    tileGrid: tileGrid,\n    tileLoadFunction: options.tileLoadFunction,\n    tilePixelRatio: options.tilePixelRatio,\n    tileUrlFunction: options.tileUrlFunction,\n    url: options.url,\n    urls: options.urls,\n    wrapX: options.wrapX !== undefined ? options.wrapX : true,\n    transition: options.transition\n  });\n\n};\n\ninherits(XYZ, TileImage);\nexport default XYZ;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/openlayers/src/ol/source/XYZ.js\n// module id = null\n// module chunks = ","/**\n * @module ol/source/OSM\n */\nimport {inherits} from '../index.js';\nimport XYZ from '../source/XYZ.js';\n\n/**\n * @classdesc\n * Layer source for the OpenStreetMap tile server.\n *\n * @constructor\n * @extends {ol.source.XYZ}\n * @param {olx.source.OSMOptions=} opt_options Open Street Map options.\n * @api\n */\nconst OSM = function(opt_options) {\n\n  const options = opt_options || {};\n\n  let attributions;\n  if (options.attributions !== undefined) {\n    attributions = options.attributions;\n  } else {\n    attributions = [OSM.ATTRIBUTION];\n  }\n\n  const crossOrigin = options.crossOrigin !== undefined ?\n    options.crossOrigin : 'anonymous';\n\n  const url = options.url !== undefined ?\n    options.url : 'https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png';\n\n  XYZ.call(this, {\n    attributions: attributions,\n    cacheSize: options.cacheSize,\n    crossOrigin: crossOrigin,\n    opaque: options.opaque !== undefined ? options.opaque : true,\n    maxZoom: options.maxZoom !== undefined ? options.maxZoom : 19,\n    reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n    tileLoadFunction: options.tileLoadFunction,\n    url: url,\n    wrapX: options.wrapX\n  });\n\n};\n\ninherits(OSM, XYZ);\n\n\n/**\n * The attribution containing a link to the OpenStreetMap Copyright and License\n * page.\n * @const\n * @type {string}\n * @api\n */\nOSM.ATTRIBUTION = '&copy; ' +\n      '<a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> ' +\n      'contributors.';\nexport default OSM;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/openlayers/src/ol/source/OSM.js\n// module id = null\n// module chunks = "],"sourceRoot":""}